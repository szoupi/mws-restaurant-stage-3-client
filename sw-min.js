importScripts("https://storage.googleapis.com/workbox-cdn/releases/3.2.0/workbox-sw.js");workbox?console.log("Yay! Workbox is loaded \ud83c\udf89"):console.log("Boo! Workbox didn't load \ud83d\ude2c");var dataUrl="http://localhost:1337/restaurants";workbox.routing.registerRoute(/\.(?:js|html|css)$/,workbox.strategies.staleWhileRevalidate({cacheName:"static-resources"}));
workbox.routing.registerRoute(/.*\.(?:png|jpg|jpeg|svg|gif|webp)/,workbox.strategies.cacheFirst({cacheName:"image-cache",plugins:[new workbox.expiration.Plugin({maxEntries:80,maxAgeSeconds:604800})]}));workbox.routing.registerRoute(/https:\/\/fonts.(?:googleapis|gstatic).com\/(.*)/,workbox.strategies.cacheFirst({cacheName:"googleapis",plugins:[new workbox.expiration.Plugin({maxEntries:10})]}));
self.addEventListener("fetch",function(a){"only-if-cached"===a.request.cache&&"same-origin"!==a.request.mode||a.respondWith(caches.match(a.request).then(function(e){if(a.request.url==dataUrl){console.log("fetching data url:"+a.request.url);var d=indexedDB.open("restaurantDB",10);d.onerror=function(c){console.log("indexedDB error: "+this.error)};d.onsuccess=function(c){console.log("Database initialised succesfully");var a=c.target.result;a.onerror=function(a){console.log("Database error: "+a.target.errorCode)};
var b=a.transaction(["restaurants"],"readwrite");b.objectStore("restaurants");fetch(dataUrl).then(function(a){console.log("data url fetched");console.log(a);return a.json()}).then(function(c){console.log("data: "+c);var b=a.transaction(["restaurants"],"readwrite").objectStore("restaurants");c.forEach(function(a){b.put(a)})});b.oncomplete=function(){console.log("Transaction completed: database modification finished")};b.onerror=function(){console.log("Transaction not opened due to error: "+b.error)}};
d.onupgradeneeded=function(a){console.log("onupgradeneeded request triggered: "+a);a=a.target.result;a.onerror=function(a){console.log("Error loading database")};a.onversionchange=function(a){console.log("version changed, user should be informed")};a.createObjectStore("restaurants",{keyPath:"name"});console.log("onupgradeneeded event triggered, object store restaurants created")}}return e||fetch(a.request)}))});